<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ski Speedometer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
            background: #f0f8ff;
        }
        #speed {
            font-size: 72px;
            font-weight: bold;
            color: #2c3e50;
        }
        #unit {
            font-size: 24px;
        }
        #maxSpeed {
            margin-top: 20px;
            font-size: 24px;
            color: #e74c3c;
        }
        .button {
            margin: 10px;
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <h1>Ski Speedometer</h1>
    <div id="speed">0</div>
    <div id="unit">km/h</div>
    <div id="maxSpeed">Max Speed: 0 km/h</div>
    <button class="button" onclick="startTracking()">Start</button>
    <button class="button" onclick="stopTracking()">Stop</button>
    <button class="button" onclick="resetMaxSpeed()">Reset</button>

    <script>
        let watchId = null;
        let maxSpeed = 0;

        // Load saved max speed from localStorage
        window.onload = function() {
            const savedMaxSpeed = localStorage.getItem('maxSkiSpeed');
            if (savedMaxSpeed) {
                maxSpeed = parseFloat(savedMaxSpeed);
                document.getElementById('maxSpeed').textContent = `Max Speed: ${maxSpeed.toFixed(1)} km/h`;
            }
        };

        function startTracking() {
            if (navigator.geolocation) {
                watchId = navigator.geolocation.watchPosition(
                    function(position) {
                        if (position.coords.speed != null) {
                            // Convert m/s to km/h
                            const speedKmh = position.coords.speed * 3.6;
                            document.getElementById('speed').textContent = speedKmh.toFixed(1);
                            
                            // Update max speed
                            if (speedKmh > maxSpeed) {
                                maxSpeed = speedKmh;
                                document.getElementById('maxSpeed').textContent = `Max Speed: ${maxSpeed.toFixed(1)} km/h`;
                                localStorage.setItem('maxSkiSpeed', maxSpeed.toString());
                            }
                        }
                    },
                    function(error) {
                        alert('Please enable location services to use the speedometer');
                    },
                    {
                        enableHighAccuracy: true,
                        maximumAge: 0,
                        timeout: 5000
                    }
                );
            }
        }

        function stopTracking() {
            if (watchId != null) {
                navigator.geolocation.clearWatch(watchId);
                watchId = null;
            }
        }

        function resetMaxSpeed() {
            maxSpeed = 0;
            localStorage.removeItem('maxSkiSpeed');
            document.getElementById('maxSpeed').textContent = 'Max Speed: 0 km/h';
        }
    </script>
</body>
</html>
